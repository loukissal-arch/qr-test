<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QR Scanner</title>

<script src="https://unpkg.com/html5-qrcode"></script>

<style>
body {
  margin: 0;
  background: #111;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  font-family: -apple-system, BlinkMacSystemFont, system-ui;
}

/* PHONE CANVAS */
#canvas {
  position: relative;
  width: 390px;
  height: 844px;
  background: #3B82F6; /* lighter blue */
  overflow: hidden;
}

/* MAIN BACKGROUND IMAGE */
#bg {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: contain;
  z-index: 0;
}

/* TIME / DATE */
#datetime {
  position: absolute;
  top: 227px;
  left: 96px;
  width: 183px;
  height: 125px;
  background: white;
  color: black;
  border-radius: 12px;
  text-align: center;
  padding-top: 12px;
  box-sizing: border-box;
  z-index: 2;
}

#time {
  font-size: 48px;
  font-weight: 600;
}

#date {
  font-size: 16px;
  font-weight: 500;
  margin-top: 4px;
}

/* INVISIBLE BUTTON AREAS */
.hotspot {
  position: absolute;
  z-index: 3;
  cursor: pointer;
}

/* ENTRY */
#entry {
  top: 356px;
  left: 43px;
  width: 305px;
  height: 115px;
}

/* EXIT */
#exit {
  top: 487px;
  left: 43px;
  width: 306px;
  height: 118px;
}

/* CAMERA OVERLAY */
#scanner {
  position: absolute;
  inset: 0;
  z-index: 10;
  display: none;
  background: black;
}

/* LIVE CAMERA */
#reader {
  position: absolute;
  inset: 0;
  z-index: 1;
}

/* PNG FRAME ON TOP */
#cameraOverlay {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  z-index: 2;
  pointer-events: none;
}
</style>
</head>

<body>

<div id="canvas">

  <!-- MAIN SCREEN -->
  <img id="bg" src="bg.jpg">

  <div id="datetime">
    <div id="time"></div>
    <div id="date"></div>
  </div>

  <div id="entry" class="hotspot"></div>
  <div id="exit" class="hotspot"></div>

  <!-- CAMERA SCREEN -->
  <div id="scanner">
    <div id="reader"></div>
    <img src="camera-overlay.png" id="cameraOverlay">
  </div>

</div>

<script>
/* TIME + DATE */
const now = new Date();
time.textContent = now.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });
date.textContent = now.toLocaleDateString('en-US', {
  month: '2-digit',
  day: '2-digit',
  year: '2-digit'
});

let qr;
let currentMode = null;

/* OPEN CAMERA */
function startScan(mode) {
  currentMode = mode;
  document.getElementById("scanner").style.display = "block";

  qr = new Html5Qrcode("reader");
  qr.start(
    { facingMode: "user" }, // ðŸ¤³ selfie camera
    { fps: 10, qrbox: 250 },
    onScanSuccess
  );
}

/* CLOSE CAMERA */
function stopScan() {
  if (qr) {
    qr.stop().then(() => {
      qr.clear();
      document.getElementById("scanner").style.display = "none";
    });
  }
}

/* SCAN SUCCESS */
function onScanSuccess(text) {
  stopScan();
  console.log("QR:", text, "MODE:", currentMode);
  alert(currentMode === "entry" ? "ENTRY SUCCESS" : "EXIT SUCCESS");
}

/* BUTTONS */
document.getElementById("entry").onclick = () => startScan("entry");
document.getElementById("exit").onclick  = () => startScan("exit");
</script>

</body>
</html>
