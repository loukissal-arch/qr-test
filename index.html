<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QR Screen – Camera</title>

<script src="https://unpkg.com/html5-qrcode"></script>

<style>
body {
  margin: 0;
  background: #111;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  font-family: -apple-system, BlinkMacSystemFont, system-ui;
}

/* FIXED PHONE CANVAS */
#canvas {
  position: relative;
  width: 390px;
  height: 844px;
  background: #0A3D91;
  overflow: hidden;
}

/* BACKGROUND IMAGE */
#bg {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: contain;
  z-index: 0;
}

/* TIME + DATE */
#datetime {
  position: absolute;
  top: 227px;
  left: 96px;
  width: 183px;
  height: 125px;
  background: white;
  color: black;
  border-radius: 12px;
  text-align: center;
  padding-top: 12px;
  box-sizing: border-box;
  z-index: 2;
}

#time {
  font-size: 48px;
  font-weight: 600;
}

#date {
  font-size: 16px;
  font-weight: 500;
  margin-top: 4px;
}

/* INVISIBLE CLICK AREAS */
.hotspot {
  position: absolute;
  cursor: pointer;
  z-index: 3;
}

/* ENTRY */
#entry {
  top: 356px;
  left: 43px;
  width: 305px;
  height: 115px;
}

/* EXIT */
#exit {
  top: 487px;
  left: 43px;
  width: 306px;
  height: 118px;
}

/* CAMERA OVERLAY */
#scanner {
  position: absolute;
  inset: 0;
  background: black;
  display: none;
  z-index: 10;
  justify-content: center;
  align-items: center;
}

#reader {
  width: 300px;
}
</style>
</head>

<body>

<div id="canvas">

  <img id="bg" src="bg.jpg">

  <!-- TIME / DATE -->
  <div id="datetime">
    <div id="time"></div>
    <div id="date"></div>
  </div>

  <!-- ENTRY / EXIT -->
  <div id="entry" class="hotspot"></div>
  <div id="exit" class="hotspot"></div>

  <!-- CAMERA -->
  <div id="scanner">
    <div id="reader"></div>
  </div>

</div>

<script>
/* SET TIME & DATE */
const now = new Date();
time.textContent = now.toLocaleTimeString('en-GB', { hour:'2-digit', minute:'2-digit' });
date.textContent = now.toLocaleDateString('en-US', { month:'2-digit', day:'2-digit', year:'2-digit' });

let currentMode = null;
let qr;

/* START CAMERA — FRONT CAMERA */
function startScan(mode) {
  currentMode = mode;
  document.getElementById("scanner").style.display = "flex";

  qr = new Html5Qrcode("reader");
  qr.start(
    { facingMode: "user" },   // ✅ FRONT CAMERA
    { fps: 10, qrbox: 250 },
    onScanSuccess
  );
}

/* STOP CAMERA */
function stopScan() {
  if (qr) {
    qr.stop().then(() => {
      qr.clear();
      document.getElementById("scanner").style.display = "none";
    });
  }
}

/* QR SUCCESS */
function onScanSuccess(text) {
  stopScan();
  console.log("QR DATA:", text);
  console.log("MODE:", currentMode);
  alert(currentMode === "entry" ? "ENTRY SUCCESS" : "EXIT SUCCESS");
}

/* CLICK HANDLERS */
document.getElementById("entry").onclick = () => startScan("entry");
document.getElementById("exit").onclick  = () => startScan("exit");
</script>

</body>
</html>
